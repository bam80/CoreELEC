#!/bin/sh

# SPDX-License-Identifier: GPL-2.0-or-later
# Copyright (C) 2018-present Team CoreELEC (https://coreelec.org)

MALIHYBRIS_DIR=/usr/lib/malihybris

if grep -q "g12b" /proc/device-tree/compatible; then
    ln -sf /usr/lib/libMali.gondul.so /var/lib/libMali.so
elif grep -q "g12a" /proc/device-tree/compatible; then
    ln -sf /usr/lib/libMali.dvalin.so /var/lib/libMali.so
elif grep -q "Gxl" /proc/device-tree/compatible; then
    ln -sf /usr/lib/libMali.m450.so /var/lib/libMali.so
fi

if grep -q "Gxm" /proc/device-tree/compatible; then
    ln -sf "$MALIHYBRIS_DIR/libEGL.so.1.0.0" /var/lib/libEGL.so
    ln -sf "$MALIHYBRIS_DIR/libGLESv1_CM.so.1.0.1" /var/lib/libGLESv1_CM.so
    ln -sf "$MALIHYBRIS_DIR/libGLESv2.so.2.0.0" /var/lib/libGLESv2.so
    ln -sf "$MALIHYBRIS_DIR/libGLESv3.so.3.0.0" /var/lib/libGLESv3.so
else
    ln -sf /usr/lib/libMali.so /var/lib/libEGL.so
    ln -sf /usr/lib/libMali.so /var/lib/libGLESv1_CM.so
    ln -sf /usr/lib/libMali.so /var/lib/libGLESv2.so
    ln -sf /usr/lib/libMali.so /var/lib/libGLESv3.so
fi
